#include <iostream>
#include <stdint.h>
#include <stdlib.h>
#include <sstream>
#include <string.h>
#include <stdio.h>
using namespace std;

int ndigits(int num);
char *int_to_char(int num);
char *soma(char *a, short int size1, char *b, short int size2, short int maxsize);

void flipstring(char *s, int size){

    char *temp = (char *)malloc(size);

    for (int i=0; i<size; i++)
        temp[i]=s[size-1-i];

    strcpy(s,temp);
}


int main(){

    char *buf1=(char *)malloc(50);
    char *buf2=(char *)malloc(50);
    char *el=(char *)malloc(1);

    int size1=50, size2=50;

    FILE *fp;


    fp=fopen("100numbers.txt","rb");

    fread(buf1,50,1,fp);
    flipstring(buf1,50);

    fread(el,1,1,fp);

    for(int j=0; j<99; j++){

        fread(buf2,50,1,fp);
        flipstring(buf2,50);
        fread(el,1,1,fp);

        //         cout << buf1 << endl << buf2<< endl;


        short int maxsize = size1>size2 ? size1+1 : size2+1;
        char *result=soma(buf1,size1,buf2,size2,maxsize);


        int eq=0;
        while( result[maxsize-1-eq] == '0')
            eq++;
        maxsize-=eq;


        size1=maxsize;

        free(buf1);
        buf1 = (char *) malloc(size1);
        buf1 = strncpy(buf1,result,maxsize);

        cout << buf1 << endl;

        //         free(result);
    }
    fclose(fp);


char *r1 = (char *)malloc(10);
char *r2 = (char *)malloc(10);
char *r3 = (char *)malloc(10);
char *r4 = (char *)malloc(10);

    strncpy(r1,buf1,10);

    strcpy(r2,r1);
    flipstring(r2,10);

    flipstring(buf1,size1+1);


    strncpy(r3,buf1,10);

    strcpy(r3,r4);
    flipstring(r4,10);

cout << r1 << endl << r2 << endl <<r3 << endl << r4 << endl;


    return 1;
}






int ndigits(int num){

    int digits=1;

    while( (num=num/10) > 0 )
        digits++;

    return digits;
}

char *int_to_char(int num){
    short int size = ndigits(num);
    char *buffer = (char *) malloc(size+1);

    for (int i=0; i<size; i++){
        buffer[i] = '0'+(num%10);
        num/=10;
    }

    return buffer;
}

char *soma(char *a, short int size1, char *b, short int size2, short int maxsize){


    char *buffer = (char *) malloc(maxsize);
    char *first  = (char *) malloc(maxsize);
    char *second = (char *) malloc(maxsize);

    for (int i=0; i<maxsize; i++){
        i<size1 ? first[i]=a[i] : first[i]='0';
        i<size2 ? second[i]=b[i] : second[i]='0';
        buffer[i]='0';
    }


    short int transporte=0;
    for (int i=0; i<maxsize-1; i++){
        
        int s = (int)(first[i]-'0') + (int)(second[i]-'0') + transporte;

        buffer[i] = s%10+'0';
        transporte=s/10;
    }

    buffer[maxsize-1] = transporte+'0';


    free(first);
    free(second);


    return buffer;
}

